import pandas as pd
import pytest

# noinspection PyUnresolvedReferences
from plotly.graph_objs import Figure

from fixtures import demo_data
from elphick.mc.mass_composition import MassComposition
import xarray as xr


def test_plot_parallel(demo_data):
    obj_mc: MassComposition = MassComposition(demo_data)

    fig: Figure = obj_mc.plot_parallel()
    fig.show()

    fig: Figure = obj_mc.plot_parallel(color='group')
    fig.show()


def test_plot_ternary(demo_data):
    obj_mc: MassComposition = MassComposition(demo_data)

    fig: Figure = obj_mc.plot_ternary(variables=['SiO2', 'Al2O3', 'LOI'])
    fig.show()

    fig: Figure = obj_mc.plot_ternary(variables=['SiO2', 'Al2O3', 'LOI'], color='group')
    fig.show()

    with pytest.raises(KeyError):
        obj_mc.plot_ternary(variables=['SiO2', 'Al2O3', 'LOX'], color='group')


